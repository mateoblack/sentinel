# Milestone v1.2: Approval Workflows

**Status:** ✅ SHIPPED 2026-01-15
**Phases:** 18-26
**Total Plans:** 18

## Overview

Add request/approve flow for sensitive access with DynamoDB state, notification hooks, and approval policies. This milestone enables teams to require approval for high-risk profile access while maintaining self-service for lower-risk operations.

## Phases

### Phase 18: Request Schema

**Goal**: Define approval request data model, state machine, and validation
**Depends on**: v1.1 complete
**Plans**: 1 plan

Plans:
- [x] 18-01: Request types with state machine and validation — completed 2026-01-15

### Phase 19: DynamoDB Backend

**Goal**: Create request storage with TTL, indexes, and query patterns
**Depends on**: Phase 18
**Plans**: 2 plans

Plans:
- [x] 19-01: Store interface and DynamoDB CRUD operations — completed 2026-01-15
- [x] 19-02: GSI query methods (ListByRequester, ListByStatus, ListByProfile) — completed 2026-01-15

### Phase 20: Request Command

**Goal**: CLI command to submit access requests with profile/duration/justification
**Depends on**: Phase 19
**Plans**: 1 plan

Plans:
- [x] 20-01: Request command with CLI configuration and tests — completed 2026-01-14

### Phase 21: List/Check Commands

**Goal**: Commands to view pending requests and check own request status
**Depends on**: Phase 20
**Plans**: 2 plans

Plans:
- [x] 21-01: List command with CLI configuration and tests — completed 2026-01-15
- [x] 21-02: Check command with status lookup — completed 2026-01-15

### Phase 22: Approve/Deny Commands

**Goal**: Approver actions with request validation and signature verification
**Depends on**: Phase 21
**Plans**: 1 plan

Plans:
- [x] 22-01: Approve/deny commands with state transitions and tests — completed 2026-01-14

### Phase 23: Request Integration

**Goal**: Wire approved requests into credential issuance flow
**Depends on**: Phase 22
**Plans**: 2 plans

Plans:
- [x] 23-01: Request checker function with FindApprovedRequest — completed 2026-01-15
- [x] 23-02: Credential issuance integration with Store field — completed 2026-01-15

### Phase 24: Notification Hooks

**Goal**: Webhook/SNS integration for request lifecycle events
**Depends on**: Phase 23
**Plans**: 4 plans

Plans:
- [x] 24-01: Notification types and Notifier interface — completed 2026-01-15
- [x] 24-02: SNS notifier implementation — completed 2026-01-15
- [x] 24-03: Webhook notifier implementation — completed 2026-01-15
- [x] 24-04: NotifyStore wrapper and CLI integration — completed 2026-01-15

### Phase 25: Approval Policies

**Goal**: Policy rules for auto-approve conditions and approval routing
**Depends on**: Phase 24
**Plans**: 3 plans

Plans:
- [x] 25-01: Approval policy schema — completed 2026-01-15
- [x] 25-02: Approval policy validation — completed 2026-01-15
- [x] 25-03: Approval policy matching — completed 2026-01-15

### Phase 26: Approval Audit Trail

**Goal**: Enhanced logging for approval request lifecycle events
**Depends on**: Phase 25
**Plans**: 2 plans

Plans:
- [x] 26-01: Approval audit trail logging infrastructure — completed 2026-01-15
- [x] 26-02: CLI approval logging integration — completed 2026-01-15

---

## Milestone Summary

**Key Decisions:**
- DynamoDB single-table design with GSIs for query patterns
- Request state machine: pending → approved/denied/expired/cancelled
- SNS and Webhook notifiers with common Notifier interface
- NotifyStore wrapper for transparent notification on state changes
- EffectRequireApproval as new policy effect type
- Auto-approve conditions based on user, time windows, and duration
- Profile-based approver routing with specific approvers list
- Approval audit trail parallel to decision logging

**Issues Resolved:**
- None (clean implementation)

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None

---

_For current project status, see .planning/ROADMAP.md_
