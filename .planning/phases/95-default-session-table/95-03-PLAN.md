---
phase: 95-default-session-table
plan: 03
type: execute
wave: 2
depends_on: ["95-01", "95-02"]
files_modified: [docs/guide/policy-reference.md, docs/guide/commands.md, docs/CHANGELOG.md]
autonomous: true
---

<objective>
Document SENTINEL_SESSION_TABLE environment variable and policy session_table field.

Purpose: Enable users to configure default session tables via documentation.
Output: Updated policy reference, commands guide, and changelog.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/94-require-server-session/94-03-SUMMARY.md

@docs/guide/policy-reference.md
@docs/guide/commands.md
@docs/CHANGELOG.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Document session_table field in policy reference</name>
  <files>docs/guide/policy-reference.md</files>
  <action>
  Update the policy-reference.md to document the session_table field behavior.

  1. In the require_server_session section (added in Phase 94), add a subsection about session_table:

  ```markdown
  #### Session Table Configuration

  The `session_table` field specifies which DynamoDB table to use for session tracking:

  ```yaml
  policies:
    - match:
        profile: prod
      effect: require_server_session
      session_table: prod-sentinel-sessions
  ```

  **Precedence order (highest to lowest):**
  1. Policy `session_table` field (from matched rule)
  2. `--session-table` CLI flag
  3. `SENTINEL_SESSION_TABLE` environment variable
  4. Empty (no session tracking - will fail if require_server_session)

  The policy-specified table overrides CLI and environment settings, ensuring security policies
  can enforce specific tables for compliance or multi-table architectures.
  ```

  2. Update the schema section to show session_table is optional on all rules.
  </action>
  <verify>Documentation file is valid markdown</verify>
  <done>Policy reference documents session_table field and precedence order</done>
</task>

<task type="auto">
  <name>Task 2: Document SENTINEL_SESSION_TABLE in commands guide</name>
  <files>docs/guide/commands.md</files>
  <action>
  Update commands.md to document the environment variable in the exec command section.

  1. In the "sentinel exec" section, add an "Environment Variables" subsection:

  ```markdown
  #### Environment Variables

  | Variable | Description |
  |----------|-------------|
  | `SENTINEL_SESSION_TABLE` | Default DynamoDB table for session tracking in server mode. Overridden by `--session-table` flag. |

  **Example:**
  ```bash
  export SENTINEL_SESSION_TABLE=sentinel-sessions
  sentinel exec --server --profile prod -- aws s3 ls
  # Session tracking enabled automatically
  ```
  ```

  2. Update the --session-table flag description to mention the env var fallback.
  </action>
  <verify>Documentation file is valid markdown</verify>
  <done>Commands guide documents SENTINEL_SESSION_TABLE env var</done>
</task>

<task type="auto">
  <name>Task 3: Add changelog entries for Phase 95</name>
  <files>docs/CHANGELOG.md</files>
  <action>
  Add entries to the v1.13.0 Unreleased section for Phase 95 features.

  In the ### Added section (or create if doesn't exist under v1.13.0):

  ```markdown
  - `SENTINEL_SESSION_TABLE` environment variable for default session table in server mode
  - Policy `session_table` field override for per-profile table configuration
  ```

  These go after the Phase 94 entries (require_server_session effect).
  </action>
  <verify>CHANGELOG follows Keep a Changelog format</verify>
  <done>CHANGELOG documents new env var and policy field</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] docs/guide/policy-reference.md includes session_table documentation
- [ ] docs/guide/commands.md includes SENTINEL_SESSION_TABLE documentation
- [ ] docs/CHANGELOG.md includes Phase 95 entries
</verification>

<success_criteria>
- All tasks completed
- Documentation is clear and follows existing style
- Precedence order clearly explained
</success_criteria>

<output>
After completion, create `.planning/phases/95-default-session-table/95-03-SUMMARY.md`
</output>
