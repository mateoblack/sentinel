---
phase: 31-notification-blast
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [notification/breakglass_types.go, notification/breakglass_types_test.go]
autonomous: true
---

<objective>
Add break-glass notification event types and BreakGlassEvent struct for security alerts.

Purpose: Enable notification delivery when break-glass is invoked, allowing security teams to receive immediate alerts about emergency access.
Output: Break-glass event types and notification payload struct parallel to the request notification system.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase summaries - notification infrastructure
@.planning/phases/24-notification-hooks/24-01-SUMMARY.md

# Source files to follow patterns from
@notification/types.go
@notification/notifier.go
@breakglass/types.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create break-glass notification event types</name>
  <files>notification/breakglass_types.go</files>
  <action>
Create break-glass notification types following the existing request notification pattern:

1. Add BreakGlassEventType constants:
   - EventBreakGlassInvoked = "breakglass.invoked"
   - EventBreakGlassClosed = "breakglass.closed"
   - EventBreakGlassExpired = "breakglass.expired"

2. Create BreakGlassEvent struct (separate from request Event):
   - Type BreakGlassEventType
   - BreakGlass *breakglass.BreakGlassEvent
   - Timestamp time.Time
   - Actor string (invoker for invoked, closer for closed, "system" for expired)

3. Add NewBreakGlassEvent constructor that sets timestamp to now.

4. Add IsValid() and String() methods for BreakGlassEventType.

Follow the exact pattern from notification/types.go but for break-glass events.
  </action>
  <verify>go build ./notification/...</verify>
  <done>BreakGlassEventType constants and BreakGlassEvent struct compile without errors</done>
</task>

<task type="auto">
  <name>Task 2: Add break-glass notification tests</name>
  <files>notification/breakglass_types_test.go</files>
  <action>
Add comprehensive tests following notification/types_test.go pattern:

1. Test BreakGlassEventType.IsValid() for all constants + invalid values
2. Test BreakGlassEventType.String() returns correct string
3. Test NewBreakGlassEvent constructor sets all fields correctly
4. Test that BreakGlass field correctly holds the break-glass event data

Use table-driven tests. Create test break-glass events using breakglass.BreakGlassEvent{} with minimal required fields.
  </action>
  <verify>go test ./notification/... -v -run "BreakGlass"</verify>
  <done>All break-glass notification type tests pass</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `go build ./notification/...` succeeds
- [ ] `go test ./notification/...` passes all tests
- [ ] No TypeScript errors introduced
</verification>

<success_criteria>
- All tasks completed
- BreakGlassEventType and BreakGlassEvent types available for use
- Tests verify correct behavior
- Code follows existing notification/types.go patterns exactly
</success_criteria>

<output>
After completion, create `.planning/phases/31-notification-blast/31-01-SUMMARY.md`
</output>
