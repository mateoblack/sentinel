---
phase: 93-docs-validation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: [docs/BOOTSTRAP.md, docs/guide/commands.md]
autonomous: true
---

<objective>
Update BOOTSTRAP.md and commands.md with v1.12 infrastructure provisioning documentation.

Purpose: Complete documentation of all new init subcommands for DynamoDB table provisioning.
Output: Updated BOOTSTRAP.md with infrastructure provisioning guide and commands.md with new command references.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@docs/BOOTSTRAP.md
@docs/guide/commands.md
@cli/init_approvals.go
@cli/init_breakglass.go
@cli/init_sessions.go
@cli/bootstrap.go
@cli/status.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add DynamoDB Table Provisioning section to BOOTSTRAP.md</name>
  <files>docs/BOOTSTRAP.md</files>
  <action>
Add a new major section "## DynamoDB Table Provisioning" after the existing "Multi-Profile Bootstrap" section and before "Custom Policy Root".

Content to add:

```markdown
## DynamoDB Table Provisioning

Sentinel features like approval workflows, break-glass access, and server mode session tracking require DynamoDB tables. These can be provisioned individually or as part of bootstrap.

### Individual Table Commands

#### `sentinel init approvals`

Creates the approval requests table for the approval workflow feature.

| Flag | Description | Default |
|------|-------------|---------|
| `--table` | DynamoDB table name | `sentinel-requests` |
| `--region` | AWS region (required) | - |
| `--aws-profile` | AWS profile for credentials | Default chain |
| `--plan` | Show what would be created (dry-run) | false |
| `--yes` / `-y` | Skip confirmation prompt | false |
| `--generate-iam` | Output IAM policy document | false |

**Examples:**

```bash
# Preview table creation
sentinel init approvals --plan --region us-east-1

# Create with confirmation prompt
sentinel init approvals --region us-east-1

# Auto-approve for scripting
sentinel init approvals --region us-east-1 --yes

# Generate IAM policy for table access
sentinel init approvals --generate-iam --region us-east-1
```

#### `sentinel init breakglass`

Creates the break-glass events table for emergency access tracking.

| Flag | Description | Default |
|------|-------------|---------|
| `--table` | DynamoDB table name | `sentinel-breakglass` |
| `--region` | AWS region (required) | - |
| `--aws-profile` | AWS profile for credentials | Default chain |
| `--plan` | Show what would be created (dry-run) | false |
| `--yes` / `-y` | Skip confirmation prompt | false |
| `--generate-iam` | Output IAM policy document | false |

**Example:**

```bash
sentinel init breakglass --region us-east-1 --yes
```

#### `sentinel init sessions`

Creates the server sessions table for server mode session tracking and revocation.

| Flag | Description | Default |
|------|-------------|---------|
| `--table` | DynamoDB table name | `sentinel-sessions` |
| `--region` | AWS region (required) | - |
| `--aws-profile` | AWS profile for credentials | Default chain |
| `--plan` | Show what would be created (dry-run) | false |
| `--yes` / `-y` | Skip confirmation prompt | false |
| `--generate-iam` | Output IAM policy document | false |

**Example:**

```bash
sentinel init sessions --region us-east-1 --yes
```

### Unified Bootstrap with Tables

The `sentinel init bootstrap` command supports `--with-*` flags to create DynamoDB tables alongside SSM policy parameters:

| Flag | Description |
|------|-------------|
| `--with-approvals` | Also create approval requests table |
| `--with-breakglass` | Also create break-glass events table |
| `--with-sessions` | Also create server sessions table |
| `--all` | Enable all optional infrastructure (equivalent to all --with-* flags) |

**Examples:**

```bash
# Bootstrap profile with approval table
sentinel init bootstrap --profile dev --with-approvals --region us-east-1

# Bootstrap with all optional infrastructure
sentinel init bootstrap --profile dev --all --region us-east-1

# Multiple profiles with all tables
sentinel init bootstrap --profile dev --profile staging --all --region us-east-1 --yes
```

### Table Schemas

Each table follows a consistent pattern:

| Table | Partition Key | GSIs | TTL |
|-------|---------------|------|-----|
| sentinel-requests | id (S) | requester-index, status-index, profile-index | expires_at |
| sentinel-breakglass | id (S) | invoker-index, status-index, profile-index | expires_at |
| sentinel-sessions | id (S) | user-index, status-index, server-instance-index | expires_at |

All tables use PAY_PER_REQUEST (on-demand) billing mode.
```
  </action>
  <verify>cat docs/BOOTSTRAP.md | grep -A5 "DynamoDB Table Provisioning"</verify>
  <done>BOOTSTRAP.md has complete DynamoDB table provisioning documentation</done>
</task>

<task type="auto">
  <name>Task 2: Update sentinel init status section with --check-tables</name>
  <files>docs/BOOTSTRAP.md</files>
  <action>
Update the existing `sentinel init status` command reference to include the new `--check-tables` flag.

Add to the flags table:

| `--check-tables` | Check DynamoDB table status | false |

Add example:

```bash
# Check infrastructure status including DynamoDB tables
sentinel init status --check-tables --region us-east-1
```

Update the sample output to show the enhanced format with infrastructure section:

```
Sentinel Status
===============

Policy Parameters (/sentinel/policies):
  dev            v3  (2026-01-15 14:30:22)
  staging        v1  (2026-01-15 14:30:25)
  prod           v5  (2026-01-16 09:15:00)

Infrastructure (us-east-1):
  sentinel-requests    DynamoDB   ACTIVE
  sentinel-breakglass  DynamoDB   NOT FOUND
  sentinel-sessions    DynamoDB   NOT FOUND

Suggestions:
  Run: sentinel init breakglass --region us-east-1
  Run: sentinel init sessions --region us-east-1

Total: 3 policy parameters
```
  </action>
  <verify>cat docs/BOOTSTRAP.md | grep -A10 "check-tables"</verify>
  <done>BOOTSTRAP.md documents --check-tables flag and enhanced status output</done>
</task>

<task type="auto">
  <name>Task 3: Add init subcommands to commands.md</name>
  <files>docs/guide/commands.md</files>
  <action>
Add documentation for the new init subcommands in the appropriate section of commands.md.

Find the "Initialization Commands" or "Bootstrap Commands" section (near sentinel init bootstrap/status/wizard) and add:

```markdown
### init approvals

Provision the DynamoDB table for approval workflow requests.

**Usage:**
```bash
sentinel init approvals --region REGION [flags]
```

**Flags:**

| Flag | Description | Default |
|------|-------------|---------|
| `--table` | DynamoDB table name | `sentinel-requests` |
| `--region` | AWS region for DynamoDB (required) | - |
| `--aws-profile` | AWS profile for credentials | Default chain |
| `--plan` | Preview without creating | false |
| `--yes` / `-y` | Skip confirmation | false |
| `--generate-iam` | Output IAM policy document | false |

---

### init breakglass

Provision the DynamoDB table for break-glass emergency access events.

**Usage:**
```bash
sentinel init breakglass --region REGION [flags]
```

**Flags:**

| Flag | Description | Default |
|------|-------------|---------|
| `--table` | DynamoDB table name | `sentinel-breakglass` |
| `--region` | AWS region for DynamoDB (required) | - |
| `--aws-profile` | AWS profile for credentials | Default chain |
| `--plan` | Preview without creating | false |
| `--yes` / `-y` | Skip confirmation | false |
| `--generate-iam` | Output IAM policy document | false |

---

### init sessions

Provision the DynamoDB table for server mode session tracking.

**Usage:**
```bash
sentinel init sessions --region REGION [flags]
```

**Flags:**

| Flag | Description | Default |
|------|-------------|---------|
| `--table` | DynamoDB table name | `sentinel-sessions` |
| `--region` | AWS region for DynamoDB (required) | - |
| `--aws-profile` | AWS profile for credentials | Default chain |
| `--plan` | Preview without creating | false |
| `--yes` / `-y` | Skip confirmation | false |
| `--generate-iam` | Output IAM policy document | false |
```

Also update the `init bootstrap` section to document the new `--with-*` flags:

| `--with-approvals` | Also create approval requests table | false |
| `--with-breakglass` | Also create break-glass events table | false |
| `--with-sessions` | Also create server sessions table | false |
| `--all` | Enable all optional infrastructure | false |

And update `init status` section to document:

| `--check-tables` | Check DynamoDB table status (requires --region) | false |
  </action>
  <verify>cat docs/guide/commands.md | grep -A5 "init approvals"</verify>
  <done>commands.md documents all new init subcommands and flags</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] docs/BOOTSTRAP.md has DynamoDB Table Provisioning section
- [ ] docs/BOOTSTRAP.md documents init approvals/breakglass/sessions
- [ ] docs/BOOTSTRAP.md documents --with-* flags for bootstrap
- [ ] docs/BOOTSTRAP.md documents --check-tables for status
- [ ] docs/guide/commands.md has init approvals command
- [ ] docs/guide/commands.md has init breakglass command
- [ ] docs/guide/commands.md has init sessions command
- [ ] docs/guide/commands.md has --with-* flags for bootstrap
- [ ] All documentation is consistent with actual CLI flags
</verification>

<success_criteria>
- All tasks completed
- Documentation accurately reflects v1.12 CLI commands
- Flag tables match actual implementation
- Examples are copy-pasteable and work correctly
</success_criteria>

<output>
After completion, create `.planning/phases/93-docs-validation/93-02-SUMMARY.md`
</output>
