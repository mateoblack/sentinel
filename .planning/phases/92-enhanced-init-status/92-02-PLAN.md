---
phase: 92-enhanced-init-status
plan: 02
type: execute
wave: 1
depends_on: []
files_modified: [bootstrap/suggestions.go, bootstrap/suggestions_test.go, cli/status.go, cli/status_test.go]
autonomous: true
---

<objective>
Add suggestion generation and shell integration hints to `sentinel init status`.

Purpose: Help users understand what infrastructure is missing and provide actionable commands to complete their setup. Include shell integration hints for users who haven't configured it yet.

Output: Enhanced status command showing suggestions for missing infrastructure and shell integration guidance.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@bootstrap/status.go
@cli/status.go
@cli/shell_init.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create suggestion generation logic in bootstrap package</name>
  <files>bootstrap/suggestions.go, bootstrap/suggestions_test.go</files>
  <action>
Create suggestion generation for missing infrastructure:

1. Create new file bootstrap/suggestions.go with:

```go
// Suggestion represents a suggested action for the user.
type Suggestion struct {
    Type    string `json:"type"`    // "command", "action"
    Message string `json:"message"` // Human-readable description
    Command string `json:"command"` // Executable command (if type is "command")
}

// SuggestionGenerator creates suggestions based on current status.
type SuggestionGenerator struct {}

// GenerateInfrastructureSuggestions returns suggestions for missing DynamoDB tables.
func (sg *SuggestionGenerator) GenerateInfrastructureSuggestions(tables []TableInfo, region string) []Suggestion
```

2. Implementation rules for GenerateInfrastructureSuggestions:
   - For each table with status "NOT_FOUND", generate a suggestion
   - Command format: `sentinel init {purpose} --region {region}`
   - Example: `sentinel init approvals --region us-east-1`
   - If multiple tables missing, generate multiple suggestions

3. Add GenerateShellSuggestion method:
   - Returns suggestion to add shell integration to rc file
   - Message: "Add shell integration for quick access"
   - Command: `eval "$(sentinel shell init --aws-profile {profile})"`
   - Takes optional awsProfile parameter

4. Tests:
   - No missing tables → no suggestions
   - One missing table → one suggestion
   - All missing tables → three suggestions
   - Shell suggestion generation
  </action>
  <verify>go build ./bootstrap/... && go test ./bootstrap/... -run TestSuggestion</verify>
  <done>SuggestionGenerator type with methods implemented, tests pass</done>
</task>

<task type="auto">
  <name>Task 2: Integrate suggestions and shell hints into CLI status output</name>
  <files>cli/status.go, cli/status_test.go</files>
  <action>
Integrate suggestions into status command output:

1. After displaying infrastructure status, call SuggestionGenerator to get suggestions

2. Display suggestions section in human output:
```
Suggestions:
  Run: sentinel init breakglass --region us-east-1
  Run: sentinel init sessions --region us-east-1

Shell Integration:
  Add to ~/.zshrc: eval "$(sentinel shell init --aws-profile dev)"
```

3. For JSON output, add suggestions array to result

4. Shell integration hint logic:
   - Only show if --aws-profile was provided (user is using a profile)
   - Detect shell from SHELL env var for ~/.bashrc vs ~/.zshrc suggestion
   - Include the --aws-profile value in the suggestion if provided

5. When no suggestions needed (all infrastructure present):
   - Don't show Suggestions section in human output
   - Include empty array in JSON output

6. Tests:
   - Suggestions displayed for missing infrastructure
   - Shell integration hint with profile
   - JSON output includes suggestions
   - No suggestions when all present
  </action>
  <verify>go build ./cli/... && go test ./cli/... -run TestStatus</verify>
  <done>Status command shows suggestions and shell hints, tests pass</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `go build ./bootstrap/... ./cli/...` succeeds
- [ ] `go test ./bootstrap/... -run TestSuggestion` passes
- [ ] `go test ./cli/... -run TestStatus` passes
- [ ] Human output shows suggestions section with actionable commands
- [ ] JSON output includes suggestions array
</verification>

<success_criteria>

- SuggestionGenerator creates suggestions for missing tables
- Shell integration hint shown with profile name
- Human output has clear Suggestions section
- JSON output includes suggestions array
- No suggestions shown when all infrastructure present
</success_criteria>

<output>
After completion, create `.planning/phases/92-enhanced-init-status/92-02-SUMMARY.md`
</output>
