---
phase: 118-dependency-security-audit
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [go.mod, go.sum, docs/SECURITY.md]
autonomous: true
---

<objective>
Audit all Go dependencies for vulnerabilities, update packages with known issues, and document the project's dependency security posture.

Purpose: Ensure all dependencies are up-to-date and free of known vulnerabilities, providing a documented baseline of the project's security status for v1.16 Security Hardening milestone.
Output: Updated go.mod/go.sum with secure package versions, comprehensive dependency security documentation.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# CI security scanning already in place (Phase 115):
@.github/workflows/govulncheck.yml
@.github/workflows/goseccheck.yml
@.github/workflows/trivy-scan.yml

# Existing security documentation:
@docs/SECURITY.md
@SECURITY.md

# Current dependencies:
@go.mod
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run dependency vulnerability audit and update packages</name>
  <files>go.mod, go.sum</files>
  <action>
Run comprehensive dependency security audit:

1. **Run govulncheck to identify vulnerabilities:**
   ```bash
   govulncheck ./...
   ```
   Document any findings - these are vulnerabilities in code paths actually used by the project.

2. **Check for outdated packages:**
   ```bash
   go list -m -u all 2>/dev/null | grep '\[' | head -30
   ```
   This shows packages with available updates.

3. **Update vulnerable or significantly outdated packages:**
   - If govulncheck reports vulnerabilities, update those packages first
   - For AWS SDK packages, keep them at consistent versions within the v1.x line
   - For indirect dependencies, only update if they have security issues

4. **Run go mod tidy:**
   ```bash
   go mod tidy
   ```

5. **Verify build and tests pass after updates:**
   ```bash
   go build ./...
   go test ./...
   ```

**IMPORTANT:**
- Do NOT downgrade any packages
- Keep all AWS SDK v2 packages consistent (don't mix v1.40.x with v1.41.x)
- If govulncheck shows no vulnerabilities, document that finding
- If updates cause test failures, investigate and fix or revert specific updates

Create a temporary file `.planning/phases/118-dependency-security-audit/audit-results.md` documenting:
- govulncheck output (clean or with findings)
- List of packages updated (if any)
- Any packages intentionally not updated and why
  </action>
  <verify>
- `go build ./...` succeeds
- `go test ./...` passes
- `.planning/phases/118-dependency-security-audit/audit-results.md` exists with audit findings
  </verify>
  <done>
- Dependency audit complete with documented results
- Any vulnerable packages updated
- go.mod/go.sum updated (if changes made) and committed
- Build and tests pass
  </done>
</task>

<task type="auto">
  <name>Task 2: Update security documentation with dependency posture</name>
  <files>docs/SECURITY.md</files>
  <action>
Update docs/SECURITY.md with a new "Dependency Security" section:

1. **Add "Dependency Security" section** after "Supported Versions":
   - Document that CI runs govulncheck, gosec, and Trivy on every PR and weekly
   - Reference the workflow files
   - Document the audit date and findings

2. **Update "Supported Versions" table** to reflect v1.16:
   - v1.16.x should be marked as supported
   - v1.15.x and below should be marked as unsupported

3. **Add "Security Scanning" subsection** under Security Best Practices:
   - Describe automated scanning in CI/CD
   - Link to GitHub Security tab for vulnerability alerts
   - Mention govulncheck for local scanning

Format for Dependency Security section:
```markdown
## Dependency Security

### Automated Scanning

Sentinel uses automated security scanning in CI/CD:

| Tool | Trigger | Purpose |
|------|---------|---------|
| govulncheck | PR, Push, Weekly | Go vulnerability database |
| gosec | PR, Push, Weekly | Static application security testing |
| Trivy | PR | Container and dependency scanning |

### Last Audit

**Date**: 2026-01-25
**Result**: [Clean/N vulnerabilities found and fixed]
**govulncheck**: [Output summary]

### Direct Dependencies

All direct dependencies in go.mod are:
- From trusted sources (official AWS SDK, established Go libraries)
- Actively maintained (commits within last 12 months)
- Free of known vulnerabilities as of audit date
```

Reference the audit-results.md from Task 1 for accurate findings.
  </action>
  <verify>
- docs/SECURITY.md contains "Dependency Security" section
- Supported Versions table shows v1.16.x
- Automated scanning table lists govulncheck, gosec, Trivy
  </verify>
  <done>
- docs/SECURITY.md updated with dependency security posture
- Documentation accurately reflects audit findings
- Supported versions updated to current release
  </done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `go build ./...` succeeds without errors
- [ ] `go test ./...` passes all tests
- [ ] audit-results.md documents the security audit findings
- [ ] docs/SECURITY.md has new "Dependency Security" section
- [ ] Supported Versions table is current (v1.16.x supported)
</verification>

<success_criteria>

- Dependency vulnerability audit completed and documented
- Any vulnerable packages identified and updated
- go.mod/go.sum clean and verified
- docs/SECURITY.md updated with dependency security posture
- All tests pass after any dependency updates
</success_criteria>

<output>
After completion, create `.planning/phases/118-dependency-security-audit/118-01-SUMMARY.md`
</output>
